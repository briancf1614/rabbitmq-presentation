<section class="generator-card">
  <header>
    <h2>AI Image Creator</h2>
    <p>Configura la tua richiesta</p>
  </header>

  <div class="form-group">
    <label for="promptInput">Descrizione</label>
    <textarea
      id="promptInput"
      [ngModel]="promptText()"
      (ngModelChange)="promptText.set($event)"
      rows="3"
      placeholder="Es: Un drago fatto di cristallo..."
      [disabled]="isLoading()">
    </textarea>
  </div>

  <div class="options-row">
    <div class="form-group half-width">
      <label for="qtyInput">Quantit√†</label>
      <input
        id="qtyInput"
        type="number"
        [ngModel]="quantity()"
        (ngModelChange)="quantity.set($event)"
        min="1"
        max="10"
        [disabled]="isLoading()">
    </div>

    <!-- Checkbox pulito -->
    <div class="checkbox-group">
      <label for="rabbitInput">
        <input
          id="rabbitInput"
          type="checkbox"
          [ngModel]="useRabbit()"
          (ngModelChange)="useRabbit.set($event)"
          [disabled]="isLoading()">
        <span>Usa RabbitMQ (async)</span>
      </label>
    </div>
  </div>

  <div class="actions">
    <button
      class="btn-primary"
      (click)="generateImage()"
      [disabled]="!promptText() || isLoading()">

      @if (isLoading()) {
        <span>Processando...</span>
      } @else {
        <span>Genera Immagini</span>
      }
    </button>
  </div>

  @if (responseMessage()) {
    <div class="alert" [class.error]="hasError()" [class.success]="!hasError()">
      {{ responseMessage() }}
    </div>
  }
</section>

@if (generatedImages().length > 0) {
  <section class="results-area">
    <h3>Tutte le Creazioni ({{ generatedImages().length }})</h3>

    <div class="gallery-grid">
      @for (imgUrl of generatedImages(); track imgUrl) {
        <div class="image-card fade-in">
          <img [src]="imgUrl" alt="AI Generated Art">
          <a [href]="imgUrl" target="_blank" class="download-link">Scarica</a>
        </div>
      }
    </div>
  </section>
}
